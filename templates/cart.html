<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
{% load staticfiles %}
<head>
    <meta charset="UTF-8">
    <title>购物车</title>
    <link rel="stylesheet" href="{% static 'layui/css/layui.css' %}">
</head>
<body>
{% csrf_token %}
    <div id="test"></div>
<hr class="layui-bg-orange">
<div id='sum' align="right" onclick="saveitem()">合计价格123123123213</div>
</body>
<script src="{% static 'jquery-3.3.1.min.js' %}"></script>
<script>
html1='{{com|safe}}';
id1="#test";
$(id1).html(html1);

function add(m){
  var n=document.getElementById(m).value;
  $("#"+m).attr("value",Number(n)+1);
};
function del(m){
var s=document.getElementById(m).value;
if(s!=1)
{
$("#"+m).attr("value",Number(s)-1);
}
else{
  alert('不能小于1件，如果想移除购物车，请点击右侧删除按钮');
}
};


function del_item(m){
    xmlhttp=new XMLHttpRequest();
    var getnum= document.getElementsByTagName("blockquote");
    xmlhttp.open("GET","/test?keyword=delete&id="+getnum[m-1].id);
    xmlhttp.send();
    location.reload();
};


function saveitem()
{
  var cart=[];
  var cart1={};
  var getnum= document.getElementsByTagName("blockquote");
  for(i=0;i<getnum.length;i++)
  {
  q=document.getElementById(String(i+1)).value;
  cart1='{"id":"'+getnum[i].id+'","qty":"'+q+'"}';
  cart.splice(1,0,cart1);
  }
  $.post({url:"/test", data:{cart,"csrfmiddlewaretoken":$('[name="csrfmiddlewaretoken"]').val()}});
  location.reload();
};
</script>

</html>